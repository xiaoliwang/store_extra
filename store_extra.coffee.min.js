(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},t=[].slice;!function(e,t){return"undefined"!=typeof module&&null!==module&&"object"==typeof exports?module.exports=t():"undefined"!=typeof define&&null!==define&&define.amd?define([],t):e.store=t(),0}(window,function(){var n,r,o,a,s,u,i,l;l=window,n=window.document,s={enabled:!0,version:"0.0.3",storageNull:null,eventFuns:{},eventIndex:0,Sys:{}},i=navigator.userAgent.toLowerCase(),(o=i.match(/rv:([\d.]+)\) like gecko/))?s.Sys.ie=o[1]:(o=i.match(/msie ([\d.]+)/))?s.Sys.ie=o[1]:(o=i.match(/firefox\/([\d.]+)/))?s.Sys.firefox=o[1]:(o=i.match(/chrome\/([\d.]+)/))?s.Sys.chrome=o[1]:(o=i.match(/opera.([\d.]+)/))?s.Sys.opera=o[1]:(o=i.match(/version\/([\d.]+).*safari/))&&(s.Sys.safari=o[1]),null!=s.Sys.ie&&(s.storageNull=""),s.transact=function(e,t,n){var r;return r=s.get(e,n),r=t(r),s.set(e,r),r},s.getAll=function(){var e;return e={},s.forEach(function(t,n){return e[t]=n}),e},s.setnx=function(e,t){return s.has(e)?!1:(s.set(e,t),!0)},s.setex=function(e,t,n){return s.set(e,n),setTimeout(function(){return s.remove(e)},t)},s.serialize=function(e){var t;return t=typeof e,"object"===t&&e instanceof RegExp&&(t="regexp",e=e.source),t+"_"+("string"===t||"regexp"===t?e:JSON.stringify(e))},s.deserialize=function(e){var t,n;if("string"!=typeof e)return void 0;t=e.indexOf("_"),n=e.substring(0,t),e=e.substring(t+1);try{switch(n){case"number":e=Number(e);break;case"boolean":e=Boolean(e);break;case"regexp":e=new RegExp(e);break;case"string":break;default:e=JSON.parse(e)}return e}catch(r){if(null!=e)return e}},r=function(){return l.localStorage?!0:!1},r()&&(a=l.localStorage,s.set=function(e,t){return null==t?s.remove(e):(a.setItem(e,s.serialize(t)),!0)},s.get=function(e,t){var n;return n=s.deserialize(a.getItem(e)),null!=n?n:t},s.has=function(e){return null!==a.getItem(e)},s.type=function(e){var t,n;return n=a.getItem(e),n?(t=n.indexOf("_"),n.substring(0,t)):void 0},s.length=function(e){var t,n,r,o,s,u;if(o=0,e)for(s=e instanceof RegExp?e:new RegExp(e),t=n=0,r=a.length;r>n;t=++n)u=a[t],s.test(u)&&++o;else o=a.length;return o},s.remove=function(e){return s.has(e)?(a.removeItem(e),!0):!1},s.clear=function(){var e;return e=a.length,a.clear(),e},s.forEach=function(e){var t,n,r,o,u;for(u=[],t=n=0,o=a.length;o>=0?o>n:n>o;t=o>=0?++n:--n)r=a.key(t),u.push(e(r,s.get(r)));return u},s.on=function(t,r){var o,a,u;return o=function(e){var o;return n.hasFocus()||(o="event"+t,e.key===o&&e.oldValue===s.storageNull&&r.apply(this,s.deserialize(e.newValue))),0},a=function(e){var o,a;return n.hasFocus()||(o=s.get("_last_storage_event_key_value"),a=o.shift(),message===t&&r.apply(this,o)),0},u="#"+ ++s.eventIndex,e.call(n,"onstorage")>=0?(n.attachEvent("onstorage",a),s.eventFuns[u]=eventFuns):(l.addEventListener("storage",o,!1),s.eventFuns[u]=o),u},s.off=function(t){var r;return r=s.eventFuns[t],e.call(n,"onstorage")<0?l.removeEventListener("storage",r,!1):n.detachEvent("onstorage",r),delete s.eventFuns[t]},s.emit=function(){var r,o;if(o=arguments[0],r=2<=arguments.length?t.call(arguments,1):[],null==o)throw new TypeError("Failed to execute 'emit' on 'store': 1 argument required, but only 0 present.");return e.call(n,"onstorage")<0?(o="event"+o,s.set(o,r),a.removeItem(o)):s.setex("_last_storage_event_key_value",500,arg)});try{u="__storejs__",s.set(u,u),s.get(u)!==u&&(s.enabled=!1),s.remove(u)}catch(c){s.enabled=!1}return s})}).call(this);