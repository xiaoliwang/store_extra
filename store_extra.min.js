"use strict";!function(e,t){"undefined"!=typeof module&&"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.store=t()}(this,function(){function e(){return r.localStorage?!0:!1}var t,n={},r=window;n.enabled=!0,n.version="0.0.1",n.storageNull=null,n.Sys={};var o,a=navigator.userAgent.toLowerCase();(o=a.match(/rv:([\d.]+)\) like gecko/))?n.Sys.ie=o[1]:(o=a.match(/msie ([\d.]+)/))?n.Sys.ie=o[1]:(o=a.match(/firefox\/([\d.]+)/))?n.Sys.firefox=o[1]:(o=a.match(/chrome\/([\d.]+)/))?n.Sys.chrome=o[1]:(o=a.match(/opera.([\d.]+)/))?n.Sys.opera=o[1]:(o=a.match(/version\/([\d.]+).*safari/))?n.Sys.safari=o[1]:0,n.Sys.ie&&(n.storageNull=""),n.set=function(e,t){},n.get=function(e,t){},n.has=function(e){},n.type=function(e){},n.length=function(e){},n.remove=function(e){},n.clear=function(){},n.forEach=function(e){},n.onChange=function(e,t){},n.on=function(e,t){},n.emit=function(){},n.transact=function(){},n.getAll=function(){var e={};return n.forEach(function(t,n){e[t]=n}),e},n.setnx=function(e,t){return n.has(e)?!1:(n.set(e,t),!0)},n.setex=function(e,t,r){n.set(e,r),setTimeout(function(){n.remove(e)},t)},n.serialize=function(e){var t=typeof e;return"object"===t&&e instanceof RegExp&&(t="regexp",e=e.source),t+"_"+("string"===t||"regexp"===t?e:JSON.stringify(e))},n.deserialize=function(e){if("string"!=typeof e)return void 0;var t=e.indexOf("_"),n=e.substring(0,t);e=e.substring(t+1);try{switch(n){case"number":e=Number(e);break;case"boolean":e=Boolean(e);break;case"regexp":e=new RegExp(e);break;case"string":break;default:e=JSON.parse(e)}return e}catch(r){return e||void 0}},e()&&(t=r.localStorage,n.set=function(e,r){return null==r||""===r?n.remove(e):(t.setItem(e,n.serialize(r)),!0)},n.get=function(e,r){var o=n.deserialize(t.getItem(e));return null!=o||""!==o?o:r},n.has=function(e){return null!==t.getItem(e)},n.type=function(e){var n=t.getItem(e);if(n){var r=n.indexOf("_");return n.substring(0,r)}return void 0},n.length=function(e){var n,r=0;if(e){n=e instanceof RegExp?e:new RegExp(e);for(var o=0;o<t.length;o++)n.test(t.key(o))&&++r;return r}return r=t.length},n.remove=function(e){return n.has(e)?(t.removeItem(e),!0):!1},n.clear=function(){var e=t.length;return t.clear(),e},n.forEach=function(e){for(var r=0;r<t.length;r++){var o=t.key(r);e(o,n.get(o))}},n.onChange=function(e,t){r.addEventListener("storage",function(r){e!==n.storageNull?r.key===e&&(r.newValue===n.storageNull?t("remove",r.key,n.deserialize(r.oldValue)):r.oldValue===n.storageNull?t("new",r.key,n.deserialize(r.newValue)):t("update",r.key,n.deserialize(r.newValue),n.deserialize(r.oldValue))):t("clear")},!1)},n.on=function(e,t){"onstorage"in document?document.attachEvent("onstorage",function(r){if(!document.hasFocus()){var o=n.get("_last_storage_event_key_value"),a=o.shift();a===e&&t.apply(this,o)}}):r.addEventListener("storage",function(r){if(!document.hasFocus()){var o="event"+e;r.key===o&&r.oldValue===n.storageNull&&t.apply(this,n.deserialize(r.newValue))}},!1)},n.emit=function(){var e=Array.prototype.slice.call(arguments);if(!(e.length>=1))throw new TypeError("Failed to execute 'emit' on 'store': 1 argument required, but only 0 present.");if("onstorage"in document)n.setex("_last_storage_event_key_value",100,e);else{var r="event"+e.shift();n.set(r,e),t.removeItem(r)}});try{var i="__storejs__";n.set(i,i),n.get(i)!==i&&(n.enabled=!1),n.remove(i)}catch(u){n.enabled=!1}return n});