"use strict";!function(e,t){"undefined"!=typeof module&&"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.store=t()}(this,function(){function e(){return r.localStorage?!0:!1}var t,n={},r=window,o=window.document;n.enabled=!0,n.version="0.0.2",n.storageNull=null,n.eventFuns={},n.eventId=0,n.Sys={};var a,i=navigator.userAgent.toLowerCase();(a=i.match(/rv:([\d.]+)\) like gecko/))?n.Sys.ie=a[1]:(a=i.match(/msie ([\d.]+)/))?n.Sys.ie=a[1]:(a=i.match(/firefox\/([\d.]+)/))?n.Sys.firefox=a[1]:(a=i.match(/chrome\/([\d.]+)/))?n.Sys.chrome=a[1]:(a=i.match(/opera.([\d.]+)/))?n.Sys.opera=a[1]:(a=i.match(/version\/([\d.]+).*safari/))?n.Sys.safari=a[1]:0,n.Sys.ie&&(n.storageNull=""),n.set=function(e,t){},n.get=function(e,t){},n.has=function(e){},n.type=function(e){},n.length=function(e){},n.remove=function(e){},n.clear=function(){},n.forEach=function(e){},n.on=function(e,t){},n.off=function(e){},n.emit=function(){},n.transact=function(){},n.getAll=function(){var e={};return n.forEach(function(t,n){e[t]=n}),e},n.setnx=function(e,t){return n.has(e)?!1:(n.set(e,t),!0)},n.setex=function(e,t,r){n.set(e,r),setTimeout(function(){n.remove(e)},t)},n.serialize=function(e){var t=typeof e;return"object"===t&&e instanceof RegExp&&(t="regexp",e=e.source),t+"_"+("string"===t||"regexp"===t?e:JSON.stringify(e))},n.deserialize=function(e){if("string"!=typeof e)return void 0;var t=e.indexOf("_"),n=e.substring(0,t);e=e.substring(t+1);try{switch(n){case"number":e=Number(e);break;case"boolean":e=Boolean(e);break;case"regexp":e=new RegExp(e);break;case"string":break;default:e=JSON.parse(e)}return e}catch(r){return e||void 0}},e()&&(t=r.localStorage,n.set=function(e,r){return null==r||""===r?n.remove(e):(t.setItem(e,n.serialize(r)),!0)},n.get=function(e,r){var o=n.deserialize(t.getItem(e));return null!=o||""!==o?o:r},n.has=function(e){return null!==t.getItem(e)},n.type=function(e){var n=t.getItem(e);if(n){var r=n.indexOf("_");return n.substring(0,r)}return void 0},n.length=function(e){var n,r=0;if(e){n=e instanceof RegExp?e:new RegExp(e);for(var o=0;o<t.length;o++)n.test(t.key(o))&&++r;return r}return r=t.length},n.remove=function(e){return n.has(e)?(t.removeItem(e),!0):!1},n.clear=function(){var e=t.length;return t.clear(),e},n.forEach=function(e){for(var r=0;r<t.length;r++){var o=t.key(r);e(o,n.get(o))}},n.on=function(e,t){function a(r){if(!document.hasFocus()){var o="event"+e;r.key===o&&r.oldValue===n.storageNull&&t.apply(this,n.deserialize(r.newValue))}}function i(r){if(!document.hasFocus()){var o=n.get("_last_storage_event_key_value");if(o){var a=o.shift();a===e&&t.apply(this,o)}}}var s="#"+ ++n.eventId;return"onstorage"in document?(o.attachEvent("onstorage",i),n.eventFuns[s]=i):(r.addEventListener("storage",a,!1),n.eventFuns[s]=a),s},n.off=function(e){"onstorage"in document?o.detachEvent("onstorage",n.eventFuns[e]):r.removeEventListener("storage",n.eventFuns[e],!1),delete n.eventFuns[e]},n.emit=function(){var e=Array.prototype.slice.call(arguments);if(!(e.length>=1))throw new TypeError("Failed to execute 'emit' on 'store': 1 argument required, but only 0 present.");if("onstorage"in document)n.setex("_last_storage_event_key_value",500,e);else{var r="event"+e.shift();n.set(r,e),t.removeItem(r)}});try{var s="__storejs__";n.set(s,s),n.get(s)!==s&&(n.enabled=!1),n.remove(s)}catch(u){n.enabled=!1}return n});